<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="《代码之丑》读书笔记，如何看到代码里的坏味道。">
<meta property="og:type" content="article">
<meta property="og:title" content="《代码之丑》读书笔记">
<meta property="og:url" content="http://example.com/2024/11/23/%E3%80%8A%E4%BB%A3%E7%A0%81%E4%B9%8B%E4%B8%91%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="个人记录">
<meta property="og:description" content="《代码之丑》读书笔记，如何看到代码里的坏味道。">
<meta property="og:locale">
<meta property="article:published_time" content="2024-11-22T16:57:37.000Z">
<meta property="article:modified_time" content="2024-11-23T13:02:08.808Z">
<meta property="article:author" content="JiuZhouu">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://example.com/2024/11/23/《代码之丑》读书笔记/"/>





  <title>《代码之丑》读书笔记 | 个人记录</title>
  








<meta name="generator" content="Hexo 7.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">个人记录</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/11/23/%E3%80%8A%E4%BB%A3%E7%A0%81%E4%B9%8B%E4%B8%91%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/custom/jiuzhou.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人记录">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">《代码之丑》读书笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-11-23T00:57:37+08:00">
                2024-11-23
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2024-11-23T21:02:08+08:00">
                2024-11-23
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/" itemprop="url" rel="index">
                    <span itemprop="name">计算机</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>《代码之丑》读书笔记，如何看到代码里的坏味道。</p>
<span id="more"></span>
<h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><p>写代码要注意<strong>正确性和可维护性</strong>；经典书籍，比如《程序设计实践》、《代码整洁之道》、《重构》等；</p>
<h1 id="坏味道自查表"><a href="#坏味道自查表" class="headerlink" title="坏味道自查表"></a>坏味道自查表</h1><ul>
<li>命名：</li>
</ul>
<ol>
<li>命名是否具有业务含义；</li>
<li>命名是否符合英语语法；</li>
</ol>
<ul>
<li>函数：</li>
</ul>
<ol>
<li>代码行是否超过__行；</li>
<li>参数列表是否超过__个；</li>
</ol>
<ul>
<li>类</li>
</ul>
<ol>
<li>类的字段是否超过__个；</li>
<li>类之间的依赖关系是否符合架构规则；</li>
</ol>
<ul>
<li>语句</li>
</ul>
<ol>
<li>是否使用for循环；</li>
<li>是否使用else；</li>
<li>是否有重复的switch;</li>
<li>一行代码中是否了连续的方法调用；</li>
<li>代码中是否出现了setter；</li>
<li>变量声明之后是否有立即再赋值；</li>
<li>集合声明之后是否有立即添加元素；</li>
<li>返回值是否可以使用Optional；</li>
</ol>
<h1 id="详细分析"><a href="#详细分析" class="headerlink" title="详细分析"></a>详细分析</h1><h2 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h2><h3 id="不精准的命名"><a href="#不精准的命名" class="headerlink" title="不精准的命名"></a>不精准的命名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public void processChapter(long chapterId) &#123;  </span><br><span class="line">    Chapter chapter = this.repository.findByChapterId(chapterId);  </span><br><span class="line">    if (chapter == null) &#123;    </span><br><span class="line">        throw new IllegalArgumentException(&quot;Unknown chapter [&quot;chapterId + &quot;]&quot;);    </span><br><span class="line">    &#125;          </span><br><span class="line">    chapter.setTranslationState(TranslationState.TRANSLATING); </span><br><span class="line">    this.repository.save(chapter);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>传递进来一个章节Id，在方法内部先从repository中获取章节Chapter，然后修改其翻译状态为TRANSLATING(翻译中)，最后再进行保存。<br>方法名processChapter(处理章节)太过宽泛，应该命名为startTranslation。<br><strong>一个好的命名应该描述意图，而非细节。</strong>编写可维护的代码要用业务语言，而不是技术语言。</p>
<h3 id="用技术术语命名"><a href="#用技术术语命名" class="headerlink" title="用技术术语命名"></a>用技术术语命名</h3><p>我们接着来看一段代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Book&gt; bookList = service.getBooks();</span><br></pre></td></tr></table></figure>
<p>bookList用技术术语命名，它声明的类型是List。<br>编程有一个重要的原则是<strong>面向接口编程</strong>，这个原则从另一个角度理解，就是<strong>不要面向实现编程，因为接口是稳定的，而实现是易变的。</strong><br>我们需要一个更面向意图的名字，比如这段代码直接命名为books。</p>
<h3 id="用业务语言写代码"><a href="#用业务语言写代码" class="headerlink" title="用业务语言写代码"></a>用业务语言写代码</h3><p>不论是不精准的命名，还是技术名称命名，归根结底是一个问题：<strong>对业务理解不到位</strong>。<br><strong>想编写可维护的代码，必须要使用业务语言</strong>。从团队的角度看，让每个人根据自己的理解来命名，确实会出现千奇百怪的名字，所以一个良好的团队实践是<strong>建立团队的词汇表</strong>，让团队成员有信息可以参考。<br>对于业务语言理解导致的坏味道，就比较难以发现，比如下面方法声明：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public void approveChapter(long chapterId, long userId) &#123;  ...&#125;</span><br></pre></td></tr></table></figure>
<p>通过业务分析，我们会发现这个userId并不是一个好的命名，因为<strong>需要更多的了解才知道这个命名的含义</strong>，所以这里更好的命名是审核人的Userid，即可以修改为reviewerUserId。<br>这种必须了解业务才能发现的坏味道，需要我们在写代码时，清晰地明白业务流程，这样不仅可以消除坏味道，还可以写出更容易维护地代码。</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>坏味道：缺乏业务含义的命名。<br>错误命名：</p>
<ul>
<li>宽泛的命名。</li>
<li>用技术术语命名。<br>命名遵循的原则：</li>
<li>描述意图，而非细节。</li>
<li>面向接口编程，接口是稳定的，实现是易变的。</li>
<li>命名出现技术名称，往往是缺少一个模型。</li>
<li>使用业务语言。</li>
</ul>
<h2 id="乱用英语"><a href="#乱用英语" class="headerlink" title="乱用英语"></a>乱用英语</h2><h3 id="违反语法规则的命名"><a href="#违反语法规则的命名" class="headerlink" title="违反语法规则的命名"></a>违反语法规则的命名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public void completedTranslate(final List&lt;ChapterId&gt; chapterIds) &#123; </span><br><span class="line">    List&lt;Chapter&gt; chapters = repository.findByChapterIdIn(chapterIds);</span><br><span class="line">    chapters.forEach(Chapter::completedTranslate);  </span><br><span class="line">    repository.saveAll(chapters); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>常见的命名规则是：<strong>类名是一个名词，表示一个对象，而方法名则是一个动词，或者是动宾短语，表示一个动作。</strong><br>completedTranslate修改为completeTranslation。</p>
<h3 id="不准确的英语词汇"><a href="#不准确的英语词汇" class="headerlink" title="不准确的英语词汇"></a>不准确的英语词汇</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public enum ChapterAuditStatus &#123; PENDING, APPROVED, REJECTED;&#125;</span><br></pre></td></tr></table></figure>
<p>audit有更官方的味道，类似翻译是审计，而review则更多是审查的意思，所以review更合适，ChapterAuditStatus改成ChapterReviewStatus。<br>建立业务词汇表的关键点就是<strong>用集体智慧，而非个体智慧，找到业务合适的通用语言，</strong>相关词汇总结为词汇表。</p>
<h3 id="英语单词的拼写错误"><a href="#英语单词的拼写错误" class="headerlink" title="英语单词的拼写错误"></a>英语单词的拼写错误</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class QuerySort &#123;  </span><br><span class="line">    private final SortBy sortBy;    </span><br><span class="line">    private final SortFiled sortFiled;    </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的sortFiled本来是想表达”排序的字段”意思，但是把Filed拼写成了Filed，就容易让人理解为”排序文件”这种迷惑的意思，所以单词拼写错误一定要注意。</p>
<h3 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h3><p>坏味道：乱用英语<br>英语使用不当：</p>
<ul>
<li>违反语法规则；</li>
<li>不准确的英语词汇；</li>
<li>英语单词拼写错误。<br>解决方法：</li>
<li>制定代码规范；</li>
<li>建立团队词汇表；</li>
<li>经常性进行代码评审。</li>
</ul>
<h2 id="去除重复"><a href="#去除重复" class="headerlink" title="去除重复"></a>去除重复</h2><p>在软件开发里，有一个重要的原则叫做 <strong>Don’t Repeat Yourself(不要重复自己，简称DRY)<strong>，更经典的叙述在《程序员修炼之道》中：</strong>在一个系统中，每一处知识都必须有单一、明确、权威地表述。</strong></p>
<h3 id="重复的结构"><a href="#重复的结构" class="headerlink" title="重复的结构"></a>重复的结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Taskpublic void sendBook() &#123;  </span><br><span class="line">    try &#123;    </span><br><span class="line">        this.service.sendBook();  </span><br><span class="line">    &#125; </span><br><span class="line">    catch (Throwable t) &#123;    </span><br><span class="line">        this.notification.send(new SendFailure(t)));    </span><br><span class="line">    throw t;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Taskpublic void sendChapter() &#123;  </span><br><span class="line">    try &#123;    </span><br><span class="line">        this.service.sendChapter();  </span><br><span class="line">    &#125; </span><br><span class="line">    catch (Throwable t) &#123;    </span><br><span class="line">        this.notification.send(new SendFailure(t)));    </span><br><span class="line">    throw t;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Taskpublic void startTranslation() &#123;  </span><br><span class="line">    try &#123;    </span><br><span class="line">        this.service.startTranslation();  </span><br><span class="line">    &#125; </span><br><span class="line">    catch (Throwable t) &#123;    </span><br><span class="line">        this.notification.send(new SendFailure(t)));    </span><br><span class="line">        throw t;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是3个业务函数：发送作品、发送章节和开始翻译，看起来这3个函数已经写的非常简洁了，但是这3段代码在结构上却有重复的，就是其中的catch语句。<br>虽然这3个函数调用的业务代码不同，但是结构是一致的，有重复的结构，我们可以把其中重复的结构即捕获异常部分给提取出来：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">private void executeTask(final Runnable runnable) &#123;  </span><br><span class="line">    try &#123;    </span><br><span class="line">        runnable.run();  </span><br><span class="line">    &#125; </span><br><span class="line">    catch (Throwable t) &#123;    </span><br><span class="line">        this.notification.send(new SendFailure(t)));    </span><br><span class="line">        throw t;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>有了这个结构，前面几个函数就可以用来改写了，对于支持函数式编程的程序语言来说，可以用语言提供的便利写法来简化代码，如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Taskpublic void sendBook() &#123;  </span><br><span class="line">    executeTask(this.service::sendBook);</span><br><span class="line">&#125;</span><br><span class="line">@Taskpublic void sendChapter() &#123;  </span><br><span class="line">    executeTask(this.service::sendChapter);</span><br><span class="line">&#125;</span><br><span class="line">@Taskpublic void startTranslation() &#123; </span><br><span class="line">    executeTask(this.service::startTranslation);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="做真正的选择"><a href="#做真正的选择" class="headerlink" title="做真正的选择"></a>做真正的选择</h3><p>还是先来看一段代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if (user.isEditor()) &#123;  </span><br><span class="line">    service.editChapter(chapterId, title, content, true);</span><br><span class="line">&#125; </span><br><span class="line">else &#123;  </span><br><span class="line">    service.editChapter(chapterId, title, content, false);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>写代码要有表达性，要能准确地把意图表达出来</strong>，是写代码过程中非常重要的一环。显然，这里的if判断是为了区分参数，而不是动作，所以我们可以稍微调整一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">boolean approved = user.isEditor();</span><br><span class="line">service.editChapter(chapterId, title, content, approved);</span><br></pre></td></tr></table></figure>
<p>注意这里的关注点，并没有直接把user.isEditor()当成参数传递给editChapter函数，原因是对于editChapter函数来说，最后一个Boolean类型的参数表示的是：是否审核通过，而不是这个用户是不是编辑。<br>这里单独用一个approved变量，就更容易读懂代码。</p>
<h3 id="小结-2"><a href="#小结-2" class="headerlink" title="小结"></a>小结</h3><p><strong>发现和去除重复结构</strong>，在我们写代码中至关重要，而最难的就是挑战我们编程习惯，能够发现重复。发现重复，一种是我们已经在泥潭中挣扎了许久才后知后觉需要修改重复代码；一种是提升自己的识别能力，能主动发现重复。<br>而这种主动发现的能力，其实就需要对<strong>软件设计有更好的理解</strong>，尤其是<strong>分离关注点</strong>的理解。<br>坏味道：重复代码<br>重复的代码：</p>
<ul>
<li>复制粘贴的代码。</li>
<li>结构重复的代码。</li>
<li>if和else代码块中的语句高度类似。<br>消灭重复代码原则：</li>
<li>每一处知识都必须有单一、明确、权威地描述。<br>需要注意：</li>
<li>转变思维，结构重复也是重复代码，要创新地看待高阶函数使用以及动作的重复。</li>
</ul>
<h2 id="长函数"><a href="#长函数" class="headerlink" title="长函数"></a>长函数</h2><h3 id="多长的函数才算长"><a href="#多长的函数才算长" class="headerlink" title="多长的函数才算长"></a>多长的函数才算长</h3><p><strong>对于函数长度容忍度高，这是导致长函数产生的关键点。</strong><br><strong>一个好的程序员面对代码库时要有不同尺度的观察能力，看设计时，要能够高屋建瓴，看代码时，要能细致入微。</strong><br>把函数写短，越短越好。只有有一个严格的标准，对代码长度容忍度降低，才会提供对细节的感知力，从而发现原本所谓细枝末节的地方隐藏的问题。<br>Python 5行左右，Java 10行左右。</p>
<h3 id="长函数的产生"><a href="#长函数的产生" class="headerlink" title="长函数的产生"></a>长函数的产生</h3><h4 id="以性能为由"><a href="#以性能为由" class="headerlink" title="以性能为由"></a>以性能为由</h4><p>我们都知道，函数调用的过程其实是一个入栈出栈的过程，当函数越多时，入栈出栈的次数就越多，这样会导致性能下降。<br>但是随着硬件的发展，和编译器、语言本身的优化，<strong>性能优化不应该是写代码的第一考量</strong>，更不应该拿这一点来写出长函数。</p>
<h4 id="平铺直叙"><a href="#平铺直叙" class="headerlink" title="平铺直叙"></a>平铺直叙</h4><p>在文章前面我们也说过，定义函数就是为了把一类动作封装，让人可以一眼看出函数意图，但是很多函数实现采用平铺直叙的方式，洋洋洒洒写了几百行，尤其对于复杂的流程，这样就容易产生长函数。<br>对于平铺直叙的代码风格，会有2个典型问题：</p>
<ol>
<li>把多个业务处理流程放在一个函数里实现；</li>
<li>把不同层次的细节放到一个函数里实现。<br>这2个问题就会导致代码逻辑分层混乱，不符合单一职责原则。<br>而解决长函数的方法就是<strong>提取函数</strong>，把一个大函数拆分为若干个小函数。在拆分过程中，<strong>时刻铭记”分离关注点”这个原则</strong>，把不同的流程、不同的层次的代码给分离开来。<br>对于提取后的函数，还有一个特点，就是函数名更容易取名和理解。比如很多长函数，逻辑非常多，只能用handleXXX来表示，或者用一个非常长的函数名来表明其意图，这在上一节中我们说过，这是一种坏味道。当长函数不存在时，我们也更容易起名，更容易理解函数。</li>
</ol>
<h4 id="一次加一点"><a href="#一次加一点" class="headerlink" title="一次加一点"></a>一次加一点</h4><p>这个场景就更常见了，我们难免会维护一些旧代码，在旧代码上新增功能，为了最小改动，我们经常只在需要的地方加一点点代码，比如最开始的代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (code == 400 || code == 401) &#123;  </span><br><span class="line">    // 做一些错误处理</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>随着后面需求越来越多，日积月累，每一次就改一点，可能会变成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if (code == 400 || code == 401 || code == 402 || ...  || code == 500 || ...  || ...  || code == 10000 || ...)</span><br><span class="line">&#123;  // 做一些错误处理&#125;</span><br></pre></td></tr></table></figure>
<p>这时再去阅读，就发现很难理解了。<br><strong>任何代码都经不起这种无意识的积累，每个人都没有错，但是结果很糟糕。</strong><br>对于这种问题该如何做呢？总不能不增加需求吧，这里有一个”童子军军规”：<strong>让营地比你来时更干净。</strong><br>在编程领域也是这样，<strong>如果我们自己对代码的改动让原有代码变得更糟糕，就需要去改进它。</strong>而这一切的前提是，自己要能发现是否会变得糟糕，所以识别代码坏味道非常必要。</p>
<h3 id="小结-3"><a href="#小结-3" class="headerlink" title="小结"></a>小结</h3><p>坏味道：长函数。<br>长函数的产生：</p>
<ul>
<li>以性能为由；</li>
<li>以平铺直叙方式写代码；</li>
<li>一次增加一点代码；<br>消灭长函数的原则：</li>
<li>定义好长函数的标准。</li>
<li>做好”分离关注点”，拆分长函数。</li>
<li>改代码时，坚守”童子军军规”。</li>
</ul>
<h2 id="大类"><a href="#大类" class="headerlink" title="大类"></a>大类</h2><p>避免写出难以理解的大类。<br>为什么不把所有的代码都写到一个文件里？<br>一方面，相同的功能模块没有办法复用；另一方面，也是更关键的，把代码都写到一个文件里，其复杂度会超出一个人能够掌握的认知范围。简言之，<strong>一个人理解的东西是有限的，没有人能同时面对所有细节</strong>。<br>人类面对复杂事物给出的解决方案是<strong>分而治之</strong>。<br>最容易产生大类的原因在于职责的不单一。<br>大类的产生往往还有一个常见的原因，就是字段未分组。<br><strong>所谓的将大类拆解成小类，本质上在做的工作是一个设计工作</strong>。我们分解的依据其实是单一职责这个重要的设计原则。<br>有些人心中会升起一些疑问：如果我们把大类都拆成小类，类的数量就会增多，那人们理解的成本是不是也会增加呢？<br>在这个问题上，程序设计语言早就已经有了很好的解决方案，所以，我们会看到在各种程序设计语言中，有诸如包、命名空间之类的机制，将各种类组合在一起。在你不需要展开细节时，面对的是一个类的集合。再进一步，还有各种程序库把这些打包出来的东西再进一步打包，<strong>让我们只要面对简单的接口，而不必关心各种细节</strong>。<br>如此层层封装，然后构建软件。</p>
<h2 id="长参数列表"><a href="#长参数列表" class="headerlink" title="长参数列表"></a>长参数列表</h2><p>处理不同类型的长参数<br>函数间共享信息的方式不止一种，除了参数列表，最常见的一种方式是全局变量。但全局变量会带给我们太多意想不到的问题，所以，在初学编程的时候，老师就会告诉我们，不要使用全局变量。从程序设计语言发展的过程中，我们也可以看到，<strong>取消全局变量已经成为了大势所趋。</strong><br>一个典型的消除长参数列表的重构手法：将参数列表封装成对象。<br>应对长参数列表主要的方式就是减少参数的数量，一种最直接的方式就是将参数列表封装成一个类。但并不是说所有的情况都能封装成类来解决，我们还要分析是否所有的参数都有相同的变动频率。</p>
<ul>
<li>变化频率相同，则封装成一个类。</li>
<li>变化频率不同的话： <ul>
<li>静态不变的，可以成为软件结构的一部分；</li>
<li>多个变化频率的，可以封装成几个类。</li>
</ul>
</li>
</ul>
<h2 id="滥用控制语句"><a href="#滥用控制语句" class="headerlink" title="滥用控制语句"></a>滥用控制语句</h2><p>无论是嵌套的代码，还是 else 语句，我们之所以要把它们视为坏味道，本质上都在追求简单，因为一段代码的分支过多，其复杂度就会大幅度增加。我们一直在说，<strong>人脑能够理解的复杂度是有限的，分支过多的代码一定是会超过这个理解范围</strong>。<br>在软件开发中，有一个衡量代码复杂度常用的标准，叫做<strong>圈复杂度（Cyclomatic complexity，简称 CC）</strong>，圈复杂度越高，代码越复杂，理解和维护的成本就越高。在圈复杂度的判定中，循环和选择语句占有重要的地位。</p>
<h2 id="缺乏封装"><a href="#缺乏封装" class="headerlink" title="缺乏封装"></a>缺乏封装</h2><p>应对火车代码和基本类型偏执问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String name = book.getAuthor().getName();</span><br></pre></td></tr></table></figure>
<p>Martin Fowler 在《重构》中给这种坏味道起的名字叫过长的消息链（Message Chains），而有人则给它起了一个更为夸张的名字：火车残骸（Train Wreck），形容这样的代码像火车残骸一般，断得一节一节的。<br>解决这种代码的重构手法叫<strong>隐藏委托关系（Hide Delegate）</strong>，说得更直白一些就是，把这种调用封装起来。<br>优化后：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Book &#123;  </span><br><span class="line">    ...  </span><br><span class="line">    public String getAuthorName() &#123;    </span><br><span class="line">        return this.author.getName();  </span><br><span class="line">    &#125;  </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String name = book.getAuthorName();</span><br></pre></td></tr></table></figure>
<p>要想摆脱初级程序员的水平，就要先从<strong>少暴露细节</strong>开始。</p>
<h2 id="变量声明与赋值分离"><a href="#变量声明与赋值分离" class="headerlink" title="变量声明与赋值分离"></a>变量声明与赋值分离</h2><p>按照我们通常的理解，一个变量的初始化是分成了声明和赋值两个部分，而我这里要说的就是，<strong>变量初始化最好一次性完成</strong>。这段代码里的变量赋值是在声明很久之后才完成的，也就是说，变量初始化没有一次性完成。<br><strong>这种代码真正的问题就是不清晰，变量初始化与业务处理混在在一起</strong>。通常来说，这种代码后面紧接着就是一大堆更复杂的业务处理。当代码混在一起的时候，我们必须小心翼翼地从一堆业务逻辑里抽丝剥茧，才能把逻辑理清，知道变量到底是怎么初始化的。很多代码难读，一个重要的原因就是把不同层面的代码混在了一起。<br>这种代码在实际的代码库中出现的频率非常高，只不过，它会以各种变形的方式呈现出来。有的变量甚至是在相隔很远的地方才做了真正的赋值，完成了初始化，这中间已经夹杂了很多的业务代码在其中，进一步增加了理解的复杂度。<br>所以，我们编程时要有一个基本原则：<strong>变量一次性完成初始化</strong>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">EpubStatus status = null;</span><br><span class="line">CreateEpubResponse response = createEpub(request);</span><br><span class="line">if (response.getCode() == 201) &#123;  </span><br><span class="line">    status = EpubStatus.CREATED;</span><br><span class="line">&#125; </span><br><span class="line">else &#123;  </span><br><span class="line">    status = EpubStatus.TO_CREATE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>提取出一个函数，将 response 转成对应的内部的 EPUB 状态。优化后：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">final CreateEpubResponse response = createEpub(request);</span><br><span class="line">final EpubStatus status = toEpubStatus(response);</span><br><span class="line">private EpubStatus toEpubStatus(final CreateEpubResponse response) &#123;</span><br><span class="line">    if (response.getCode() == 201) &#123;    </span><br><span class="line">        return EpubStatus.CREATED;  </span><br><span class="line">    &#125;  </span><br><span class="line">    return EpubStatus.TO_CREATE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上一讲，我们讲了可变的数据会带来怎样的影响，其中的一个结论是，尽可能编写不变的代码。这里其实是这个话题的延伸，<strong>尽可能使用不变的量</strong>。</p>
<h2 id="依赖混乱"><a href="#依赖混乱" class="headerlink" title="依赖混乱"></a>依赖混乱</h2><p>你可能还没发现问题，代码就已经无法挽救了<br>今天我们讲了由于代码依赖关系而产生的坏味道，一种是<strong>缺少防腐层，导致不同代码糅合在一起</strong>，一种是<strong>在业务代码中出现了具体的实现类</strong>。<br>缺少防腐层，会让请求对象传导到业务代码中，造成了业务与外部接口的耦合，也就是业务依赖了一个外部通信协议。一般来说，业务的稳定性要比外部接口高，这种反向的依赖就会让业务一直无法稳定下来，继而在日后带来更多的问题。解决方案自然就是引入一个防腐层，将业务和接口隔离开来。<br>业务代码中出现具体的实现类，实际上是违反了依赖倒置原则。因为违反了依赖倒置原则，业务代码也就不可避免地受到具体实现的影响，也就造成了业务代码的不稳定。<strong>识别一段代码是否属于业务，我们不妨问一下，看把它换成其它的东西，是否影响业务。</strong>解决这种坏味道就是引入一个模型，将业务与具体的实现隔离开来。<br><strong>代码应该向着稳定的方向依赖。</strong></p>
<h2 id="不一致的代码"><a href="#不一致的代码" class="headerlink" title="不一致的代码"></a>不一致的代码</h2><p>为什么你的代码总被吐槽难懂？<br>大多数程序员都是在一个团队中工作，对于一个团队而言，一致性是非常重要的一件事。因为<strong>不一致会造成认知上的负担</strong>，在一个系统中，做类似的事情，却有不同的做法，或者起到类似作用的事物，却有不同的名字，这会让人产生困惑。所以，即便是不甚理想的标准，也比百花齐放要好。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enum DistributionChannel &#123;  WEBSITE,  KINDLE_ONLY,  ALL&#125;</span><br></pre></td></tr></table></figure>
<p><strong>表示类似含义的代码应该有一致的名字</strong>。优化后：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enum DistributionChannel &#123;  WEBSITE,  KINDLE,  ALL&#125;</span><br></pre></td></tr></table></figure>
<p>代码中的不一致：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">public void createBook(final List&lt;BookId&gt; bookIds) throws IOException &#123;  </span><br><span class="line">List&lt;Book&gt; books = bookService.getApprovedBook(bookIds)  CreateBookParameter parameter = toCreateBookParameter(books)  HttpPost post = createBookHttpRequest(parameter)  httpClient.execute(post)&#125;</span><br></pre></td></tr></table></figure>
<p>这是一段在翻译引擎中创建作品的代码。首先，根据要处理的作品 ID 获取其中已经审核通过的作品，然后，发送一个 HTTP 请求在翻译引擎中创建出这个作品。<br>这么短的一段代码有什么问题吗？问题就在于这段代码中的不一致。你可能会想：“不一致？不一致体现在哪里呢？”答案就是，<strong>这些代码不是一个层次的代码。</strong><br>通过了解这段代码的背景，你可能已经看出一些端倪了。首先是获取审核通过的作品，这是一个业务动作，接下来的三行其实是在做一件事，也就是发送创建作品的请求。具体到代码上，这三行代码分别是创建请求的参数，根据参数创建请求，最后，再把请求发送出去。这三行代码合起来完成了一个发送创建作品请求这么一件事，而这件事才是一个完整的业务动作。<br>所以，我说这个函数里的代码并不在一个层次上，有的是业务动作，有的是业务动作的细节。理解了这一点，我们就可以把这些业务细节的代码提取到一个函数里：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public void createBook(final List&lt;BookId&gt; bookIds) throws IOException &#123;  </span><br><span class="line">    List&lt;Book&gt; books = bookService.getApprovedBook(bookIds)  createRemoteBook(books)</span><br><span class="line">&#125;</span><br><span class="line">private void createRemoteBook(List&lt;Book&gt; books) throws IOException &#123;  </span><br><span class="line">    CreateBookParameter parameter = toCreateBookParameter(books)         HttpPost post = createBookHttpRequest(parameter)  httpClient.execute(post)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一说到分层，大多数人想到的只是模型的分层，很少有人会想到在函数的语句中也要分层。各种层次的代码混在一起，许多问题也就随之而来了，<strong>最典型莫过于我们之前讲过的长函数。</strong><br><strong>很多程序员纠结的技术问题，其实是一个软件设计问题</strong>，不要通过奇技淫巧去解决一个本来不应该被解决的问题。</p>
<h2 id="落后的代码风格"><a href="#落后的代码风格" class="headerlink" title="落后的代码风格"></a>落后的代码风格</h2><p><strong>使用“新”的语言特性和程序库升级你的代码</strong><br><strong>随着时间的流逝，总会有一些新的方案产生，替换原有的方案。</strong>这其中，最明显的一个例子就是程序设计语言。没有哪门语言是完美的，所以，<strong>只要有一个活跃的社区</strong>，这门语言就会不断地演进。<br>从 C++ 11 开始，C++ 开始出现了大规模的演化，让之前学习 C++ 的人感觉自己就像没学过这门语言一样；Python 2 与 Python 3 甚至是不兼容的演化；Java 也是每隔一段时间就会出现一次大的语言演进。<br>也正是因为语言本身的演化，在不同时期接触不同版本的程序员写出来的程序，甚至不像是在用同一门语言在编程。所以，<strong>我们有机会看到在同一个代码库中，各种不同时期风格的代码并存。</strong><br>通常来说，<strong>新的语言特性都是为了提高代码的表达性，减少犯错误的几率。</strong>所以，在实践中，我是非常鼓励你采用新的语言特性写代码的。</p>
<h2 id="代码评审"><a href="#代码评审" class="headerlink" title="代码评审"></a>代码评审</h2><p>我在《10x 程序员工作法》里，花了一个模块的篇幅讲了沟通反馈，我们希望沟通要尽可能透明，尽可能及时。把这样的理解放到代码评审中，<strong>就是要尽可能多暴露问题，尽可能多做代码评审。</strong><br>代码评审要暴露哪些问题？</p>
<ul>
<li>实现方案的正确性；</li>
<li>算法的正确性；</li>
<li>代码的坏味道。<br><strong>评审周期过长是有问题的，周期过长，累积的问题就会增多，造成的结果就是太多问题让人产生无力感。</strong>如果遇到实现方案存在问题，<strong>要改动的代码就太多了</strong>，甚至会影响到项目的发布。<br>而提升评审的频率，评审的周期就会缩短，每个周期内写出来的代码就是有限的，人是有心力去修改的。<br>我在《10x 程序员工作法》讲过极限编程的理念，就是把好的实现推向极致，而代码评审的极致实践就是<strong>结对编程</strong>。<br>结对编程就是两个人一起写一段代码，一个人主要负责写，一个人则站在用外部视角保证这段代码的正确性。好的结对编程对两个人的精力集中度要求是很高的，两个人一起写一天代码其实是很累的一件事，不过，也正是因为代码是两个人一起写，代码质量会提高很多。<br>从我之前经历的一些团队实践来看，结对编程还有一个额外的好处，就是<strong>对于团队中的新人提升极大，这就是拜结对编程这种高强度的训练和反馈所赐</strong>。高强度的训练和反馈，本质上就是一种刻意练习，而刻意练习是一个人提升最有效的方式。</li>
</ul>
<h2 id="新需求"><a href="#新需求" class="headerlink" title="新需求"></a>新需求</h2><p>一个有生命力的代码不会保持静止，新的需求总会到来，所以，<strong>写代码时需要时时刻刻保持嗅觉。</strong><br>我用了两个例子给你讲了新需求到来时需要关注的地方，它们分别是：</p>
<ul>
<li>增加新接口；</li>
<li>改动实体。<br>接口和实体，其实也是一个系统对外界产生影响的重要部分，一个是对客户端提供能力，一个是产生持久化信息。所以，我们必须谨慎地思考它们的变动，它们也是坏味道产生的高发地带。<br>对于接口，<strong>我们对外提供得越少越好</strong>，而对于实体，我们必须仔细分析它们扮演的角色。</li>
</ul>
<h2 id="结束语-写代码是一件可以一生精进的事"><a href="#结束语-写代码是一件可以一生精进的事" class="headerlink" title="结束语 | 写代码是一件可以一生精进的事"></a>结束语 | 写代码是一件可以一生精进的事</h2><p>写代码是一门手艺，需要不断地打磨。<br>我在《软件设计之美》中讲过，<strong>一个好的设计是在一个“小内核”上构建起来，然后，逐步添加更多模型。</strong>我们的知识拓展过程也是如此。我的“小内核”就是编写代码这件事，所有一切知识的拓展都是围绕这个内核展开的。</p>
<h1 id="第二曲线"><a href="#第二曲线" class="headerlink" title="第二曲线"></a>第二曲线</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>任何事物的发展，都有一个生命周期， 在这个生命周期里，有起始期、成长期、高峰期、下滑期和衰落期。<br>第二曲线，就是在高峰期到来或者消失 前，找到另一条新的高成长性曲线，获得持续性增长。</p>
<h2 id="T型人才"><a href="#T型人才" class="headerlink" title="T型人才"></a>T型人才</h2><p>成为T型人才</p>
<ul>
<li>T 型人才，简言之，一专多能</li>
<li>专，要有深度，能，要有广度</li>
<li>除了自身的专家技能之外，再有一些辅助技能</li>
</ul>
<h2 id="表达-每个人都可以习得的技能"><a href="#表达-每个人都可以习得的技能" class="headerlink" title="表达:每个人都可以习得的技能"></a>表达:每个人都可以习得的技能</h2><ul>
<li>表达:把事情有结构的讲清楚，这是一种重要的职业技能， 也可以成为每个人的辅助技能</li>
<li>具备表达能力的人可以写文章、做演讲</li>
<li>表达能力强的人可以有另一种可能性 <ul>
<li>写自媒体</li>
<li>写专栏</li>
<li>讲课</li>
</ul>
</li>
<li>表达能力是可以习得的</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2024/11/23/20241123_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/" rel="next" title="项目管理">
                <i class="fa fa-chevron-left"></i> 项目管理
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2024/11/24/20241124_%E8%8B%B1%E8%AF%AD/" rel="prev" title="英语">
                英语 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/custom/jiuzhou.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%80%E5%A7%8B"><span class="nav-number">1.</span> <span class="nav-text">开始</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9D%8F%E5%91%B3%E9%81%93%E8%87%AA%E6%9F%A5%E8%A1%A8"><span class="nav-number">2.</span> <span class="nav-text">坏味道自查表</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90"><span class="nav-number">3.</span> <span class="nav-text">详细分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%91%BD%E5%90%8D"><span class="nav-number">3.1.</span> <span class="nav-text">命名</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E7%B2%BE%E5%87%86%E7%9A%84%E5%91%BD%E5%90%8D"><span class="nav-number">3.1.1.</span> <span class="nav-text">不精准的命名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E6%8A%80%E6%9C%AF%E6%9C%AF%E8%AF%AD%E5%91%BD%E5%90%8D"><span class="nav-number">3.1.2.</span> <span class="nav-text">用技术术语命名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E4%B8%9A%E5%8A%A1%E8%AF%AD%E8%A8%80%E5%86%99%E4%BB%A3%E7%A0%81"><span class="nav-number">3.1.3.</span> <span class="nav-text">用业务语言写代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">3.1.4.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B9%B1%E7%94%A8%E8%8B%B1%E8%AF%AD"><span class="nav-number">3.2.</span> <span class="nav-text">乱用英语</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9D%E5%8F%8D%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99%E7%9A%84%E5%91%BD%E5%90%8D"><span class="nav-number">3.2.1.</span> <span class="nav-text">违反语法规则的命名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E5%87%86%E7%A1%AE%E7%9A%84%E8%8B%B1%E8%AF%AD%E8%AF%8D%E6%B1%87"><span class="nav-number">3.2.2.</span> <span class="nav-text">不准确的英语词汇</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8B%B1%E8%AF%AD%E5%8D%95%E8%AF%8D%E7%9A%84%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF"><span class="nav-number">3.2.3.</span> <span class="nav-text">英语单词的拼写错误</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93-1"><span class="nav-number">3.2.4.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%BB%E9%99%A4%E9%87%8D%E5%A4%8D"><span class="nav-number">3.3.</span> <span class="nav-text">去除重复</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E5%A4%8D%E7%9A%84%E7%BB%93%E6%9E%84"><span class="nav-number">3.3.1.</span> <span class="nav-text">重复的结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%81%9A%E7%9C%9F%E6%AD%A3%E7%9A%84%E9%80%89%E6%8B%A9"><span class="nav-number">3.3.2.</span> <span class="nav-text">做真正的选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93-2"><span class="nav-number">3.3.3.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%BF%E5%87%BD%E6%95%B0"><span class="nav-number">3.4.</span> <span class="nav-text">长函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%95%BF%E7%9A%84%E5%87%BD%E6%95%B0%E6%89%8D%E7%AE%97%E9%95%BF"><span class="nav-number">3.4.1.</span> <span class="nav-text">多长的函数才算长</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%BF%E5%87%BD%E6%95%B0%E7%9A%84%E4%BA%A7%E7%94%9F"><span class="nav-number">3.4.2.</span> <span class="nav-text">长函数的产生</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A5%E6%80%A7%E8%83%BD%E4%B8%BA%E7%94%B1"><span class="nav-number">3.4.2.1.</span> <span class="nav-text">以性能为由</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B9%B3%E9%93%BA%E7%9B%B4%E5%8F%99"><span class="nav-number">3.4.2.2.</span> <span class="nav-text">平铺直叙</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E6%AC%A1%E5%8A%A0%E4%B8%80%E7%82%B9"><span class="nav-number">3.4.2.3.</span> <span class="nav-text">一次加一点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93-3"><span class="nav-number">3.4.3.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E7%B1%BB"><span class="nav-number">3.5.</span> <span class="nav-text">大类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%BF%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8"><span class="nav-number">3.6.</span> <span class="nav-text">长参数列表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BB%A5%E7%94%A8%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5"><span class="nav-number">3.7.</span> <span class="nav-text">滥用控制语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%BA%E4%B9%8F%E5%B0%81%E8%A3%85"><span class="nav-number">3.8.</span> <span class="nav-text">缺乏封装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E4%B8%8E%E8%B5%8B%E5%80%BC%E5%88%86%E7%A6%BB"><span class="nav-number">3.9.</span> <span class="nav-text">变量声明与赋值分离</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%9D%E8%B5%96%E6%B7%B7%E4%B9%B1"><span class="nav-number">3.10.</span> <span class="nav-text">依赖混乱</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8D%E4%B8%80%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="nav-number">3.11.</span> <span class="nav-text">不一致的代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%90%BD%E5%90%8E%E7%9A%84%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC"><span class="nav-number">3.12.</span> <span class="nav-text">落后的代码风格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E8%AF%84%E5%AE%A1"><span class="nav-number">3.13.</span> <span class="nav-text">代码评审</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%B0%E9%9C%80%E6%B1%82"><span class="nav-number">3.14.</span> <span class="nav-text">新需求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%93%E6%9D%9F%E8%AF%AD-%E5%86%99%E4%BB%A3%E7%A0%81%E6%98%AF%E4%B8%80%E4%BB%B6%E5%8F%AF%E4%BB%A5%E4%B8%80%E7%94%9F%E7%B2%BE%E8%BF%9B%E7%9A%84%E4%BA%8B"><span class="nav-number">3.15.</span> <span class="nav-text">结束语 | 写代码是一件可以一生精进的事</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E6%9B%B2%E7%BA%BF"><span class="nav-number">4.</span> <span class="nav-text">第二曲线</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5"><span class="nav-number">4.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#T%E5%9E%8B%E4%BA%BA%E6%89%8D"><span class="nav-number">4.2.</span> <span class="nav-text">T型人才</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A8%E8%BE%BE-%E6%AF%8F%E4%B8%AA%E4%BA%BA%E9%83%BD%E5%8F%AF%E4%BB%A5%E4%B9%A0%E5%BE%97%E7%9A%84%E6%8A%80%E8%83%BD"><span class="nav-number">4.3.</span> <span class="nav-text">表达:每个人都可以习得的技能</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JiuZhouu</span>

  
</div>






  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
